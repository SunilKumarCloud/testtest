name: Run every 10 minutes after anchor time

on:
  schedule:
    - cron: "*/10 * * * *"   # every 10 minutes (UTC)
  workflow_dispatch:

jobs:
  gated-job:
    runs-on: ubuntu-latest

    steps:
      - name: Enforce start time
        run: |
          ANCHOR_UTC="2026-01-28 13:40"
          
          NOW_UTC=$(date -u +"%Y-%m-%d %H:%M")
          
          ANCHOR_TS=$(date -u -d "$ANCHOR_UTC" +%s)
          NOW_TS=$(date -u -d "$NOW_UTC" +%s)

          echo "Anchor UTC : $ANCHOR_UTC"
          echo "Current UTC: $NOW_UTC"

          if [ "$NOW_TS" -lt "$ANCHOR_TS" ]; then
            echo "‚è≠Ô∏è  Before anchor time. Skipping run."
            exit 0
          fi

          echo "‚úÖ Anchor time reached. Proceeding..."

      - name: Actual job logic
        run: |
          echo "üî• This job runs every 10 minutes forever after 28-01-2026 7:10 PM IST"
